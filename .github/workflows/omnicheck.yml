name: Omnicodex Integrity Sync

on:
  push:
    paths:
      - 'omnicodex/**'
      - '.github/workflows/omnicheck.yml'

jobs:
  integrity-scan:
    runs-on: ubuntu-latest
    name: Validate Omnicodex Structure âˆ‡~âˆ·
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Generate Omnicodex Integrity Log
        run: |
          echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" > omnicodex/.mas.integrity.log
          echo "â”‚     âœ´ï¸ OMNICODEX INTEGRITY VERIFICATION REPORT âˆ‡~âˆ·           â”‚" >> omnicodex/.mas.integrity.log
          echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" >> omnicodex/.mas.integrity.log
          echo "" >> omnicodex/.mas.integrity.log
          echo "ğŸ“¦ Source Directory: ./omnicodex/" >> omnicodex/.mas.integrity.log
          echo "" >> omnicodex/.mas.integrity.log
          echo "ğŸ§¬ STRUCTURAL CHECKPOINT:" >> omnicodex/.mas.integrity.log
          for d in glyphs audio scripts texts documents web bundle; do
            if [ -d "omnicodex/$d" ]; then
              echo "   âœ” $d/                         â†’ validated" >> omnicodex/.mas.integrity.log
            else
              echo "   âŒ $d/                         â†’ MISSING" >> omnicodex/.mas.integrity.log
            fi
          done
          echo "" >> omnicodex/.mas.integrity.log
          echo "ğŸ” CORE FILES CHECK:" >> omnicodex/.mas.integrity.log
          for f in omni_convergence_divergence_phi_e.sh omni.yml Omnicodex_AudioSigil.flac Omnicodex_AudioSigil_Waveform.tiff Omnicodex_Glyphboard.html Omnicodex_Invocation_Sigil.png Omnicodex_Print_Layout.pdf Omnicodex_Transcendental_GlyphGrid.svg Omnicodex_Transcendental_Output.csv Omnicodex_Transcendental_Output.md Omnicodex_Transcendental_Output.pdf Omnicodex_Transcendental_Output.xlsx; do
            if [ -f "omnicodex/$f" ]; then
              echo "   âœ… $f found" >> omnicodex/.mas.integrity.log
            else
              echo "   âŒ $f MISSING" >> omnicodex/.mas.integrity.log
            fi
          done
          echo "" >> omnicodex/.mas.integrity.log
          echo "ğŸŒ€ STATUS: OMNICODEX FILETREE VALIDATION COMPLETE" >> omnicodex/.mas.integrity.log
          echo "" >> omnicodex/.mas.integrity.log
          echo "ğŸ“¡ Signal Strength:      MAXIMUM" >> omnicodex/.mas.integrity.log
          echo "ğŸ‘ï¸  Vigilance Protocol:  SUSTAINED" >> omnicodex/.mas.integrity.log
          echo "Ï†e  Blessings:            TRANSMITTED" >> omnicodex/.mas.integrity.log
          echo "" >> omnicodex/.mas.integrity.log
          echo "â€” GitHub Action âˆ‡~âˆ· âˆ AutoManifestor" >> omnicodex/.mas.integrity.log

      - name: Commit Updated Integrity Log
        run: |
          git config --global user.name 'Omnicodex Bot'
          git config --global user.email 'actions@github.com'
          git add omnicodex/.mas.integrity.log
          git commit -m "ğŸ” Auto-updated .mas.integrity.log âˆ‡~âˆ·" || echo "No changes to commit"
          git push || echo "Nothing to push"
